import{G as v,j as a}from"./app-BhOsPJ8v.js";import{B as C}from"./button-_M8VdPMJ.js";import{c as T,C as N,a as y,b as D,d as S,e as $}from"./card-2rcK8Uzh.js";import{I as m}from"./input-DfoBfsiM.js";import{L as p}from"./label-BcpOi1vL.js";import{T as A,a as L,b as g,c as h}from"./tabs-FXOwAsi1.js";import{A as I}from"./AdminLayout-Bh7w6y9q.js";import{D as w}from"./DataTable-CrPfqC1r.js";import{rekapColumns as R}from"./rekapColumn-BsoeorzI.js";import{C as B}from"./CommandCombobox-CuLhOo98.js";import"./id-VFStllgx.js";import"./index-Cq-KRWnH.js";import"./index-BbUQSan3.js";import"./index-Decy9dsL.js";import"./index-BZT5xH-c.js";import"./index-oDVHq9e5.js";import"./chevron-right-D-nFaWsJ.js";import"./check-CUHmrBqO.js";import"./createLucideIcon-Dh0RT_dH.js";import"./x-CFT6KP3J.js";import"./index-CQZJ7SKH.js";import"./index-Cn1hTGmm.js";import"./table-BopenJfx.js";import"./chevron-down-DXh7kGer.js";import"./search-DqVxRVeT.js";import"./checkbox-DQ0msOBm.js";import"./index-D60drR72.js";import"./Delete-CjAhbz1N.js";import"./index-BWgpldsQ.js";import"./iconBase-CJ4l1MQW.js";import"./Edit-BDj3yX6-.js";import"./index-BVAqS8KA.js";import"./sweetalert2.all-CpNQEsKo.js";import"./arrow-up-down-DgkYT2DH.js";const xa=({rekaps:u,pesanans:d})=>{var c;console.log(u);const{data:n,setData:l,post:x,processing:b,reset:j}=v({pesanan_id:null,status:"keluar",tabung_per_produk:[]}),_=r=>{const s=parseInt(r);if(isNaN(s))return;const e=d.find(o=>o.id===s);if(!e)return;l("pesanan_id",e.id),console.log(e);const i=e.details.map(o=>({produk_id:o.produk.id,produk_nama:o.produk.nama_produk,tabung:Array(o.quantity).fill("")}));l("tabung_per_produk",i)},f=(r,s,e)=>{const i=[...n.tabung_per_produk];i[r].tabung[s]=e,l("tabung_per_produk",i)},k=r=>{r.preventDefault(),console.log("Submitting data:",n),x(route("staffgudang.rekap.store"),{data:n,onSuccess:()=>{j("pesanan_id","status","tabung_per_produk"),l("pesanan_id",null)}})},t=d==null?void 0:d.find(r=>r.id===n.pesanan_id);return a.jsx(I,{children:a.jsxs(A,{defaultValue:"account",className:"w-full",children:[a.jsxs(L,{className:"grid w-full grid-cols-2",children:[a.jsx(g,{value:"account",children:"Data Table"}),a.jsx(g,{value:"form",children:"Tambah Data"})]}),a.jsx(h,{value:"account",children:a.jsx(w,{data:u,columns:R})}),a.jsx(h,{value:"form",children:a.jsx(T,{children:a.jsxs("form",{onSubmit:k,children:[a.jsxs(N,{children:[a.jsx(y,{children:"Tambah Data Rekap"}),a.jsx(D,{children:"Masukkan data rekap tabung berdasarkan pesanan dan produk."})]}),a.jsxs(S,{className:"grid gap-4",children:[a.jsxs("div",{className:"grid gap-2",children:[a.jsx(p,{children:"Pesanan"}),a.jsx(B,{options:d.map(r=>{var s;return{label:`${r.nomor_invoice??`#${r.id}`} - ${((s=r.pelanggan)==null?void 0:s.nama_pelanggan)??"-"}`,value:r.id.toString()}}),value:((c=n.pesanan_id)==null?void 0:c.toString())??"",onValueChange:_,placeholder:"Pilih pesanan"})]}),n.pesanan_id&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx(p,{children:"Pelanggan"}),a.jsx(m,{value:(t==null?void 0:t.pelanggan.nama_pelanggan)??"",readOnly:!0})]}),a.jsxs("div",{children:[a.jsx(p,{children:"Produk"}),a.jsx(m,{value:Array.isArray(t==null?void 0:t.details)?t.details.map(r=>r.produk.nama_produk).join(", "):"",readOnly:!0})]})]}),a.jsxs("div",{children:[a.jsx(p,{children:"Status"}),a.jsx("select",{className:"w-full border px-3 py-2 rounded-md",value:n.status,onChange:r=>l("status",r.target.value),children:a.jsx("option",{value:"keluar",children:"Keluar"})})]}),n.tabung_per_produk.map((r,s)=>a.jsxs("div",{className:"mb-4 p-4 border rounded",children:[a.jsx("h2",{className:"font-bold mb-2",children:r.produk_nama}),r.tabung.map((e,i)=>a.jsxs("div",{className:"mb-2",children:[a.jsxs(p,{children:["Tabung #",i+1]}),a.jsx(m,{value:e,onChange:o=>f(s,i,o.target.value)})]},`pesanan-${n.pesanan_id}-produk-${r.produk_id}-tabung-${i}`))]},r.produk_id))]})]}),a.jsx($,{children:a.jsx(C,{type:"submit",disabled:b,children:"Simpan Rekap"})})]})})})]})})};export{xa as default};
